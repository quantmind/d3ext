{
    "release": {
        "giottojs": {
            "note_file": "docs/notes.md"
        }
    },
    "requirejs": {
        "giottojs": {
            "name": "giottojs/app",
            "out": "giottojs/media/giottojs/giottojs.js'"
        },
        "paths": [
            "giotto",
            "angular",
            "angular-sanitize"
        ]
    },
    "httpcopy": {
        "sandstone": {
            "src": [
                "https://bootswatch.com/sandstone/_bootswatch.scss",
                "https://bootswatch.com/sandstone/_variables.scss"
            ],
            "target": "scss/bootswatch/sandstone/"
        },
        "slate": {
            "src": [
                "https://bootswatch.com/slate/_bootswatch.scss",
                "https://bootswatch.com/slate/_variables.scss"
            ],
            "target": "scss/bootswatch/slate/"
        }
    },
    "sass": {
        "options": {
            "command": "./node_modules/.bin/node-sass"
        },
        "giotto": {
            "files": {
                "build/sandstone.css": "scss/sandstone.scss",
                "build/slate.css": "scss/slate.scss"
            }
        },
        "giottojs": {
            "files": {
                "giottojs/media/sandstone.css": "scss/giottojs-sandstone.scss",
                "giottojs/media/slate.css": "scss/giottojs-slate.scss"
            }
        }
    },
    "shell": {
        "d3_quant_path": {
            "command": "cd ../d3-quant && pwd"
        },
        "d3-quant-link": {
            "command": ["rm -rf ./node_modules/d3-quant",
                        "ln -s ${d3_quant_path} ${repo_path}/node_modules/d3-quant"]
        },
        "giotto": {
            "command": ["npm test",
                        "./node_modules/.bin/uglifyjs ./build/giotto.js -c -m -o ./build/giotto.min.js"]
        },
        "giotto-bundle": {
            "command": ["zip -j build/giotto.zip -- LICENSE README.md build/*.js build/*.css"]
        },
        "giottojs": {
            "command": ["cp build/giotto.js giottojs/media/giotto.js",
                        "$python manage.py media --js-src giottojs/media",
                        "./node_modules/requirejs/bin/r.js -o ./giottojs/bundle.js optimize=none",
                        "./node_modules/.bin/uglifyjs ./giottojs/media/giottojs.js -c -m -o ./giottojs/media/giottojs.min.js"]
        },
        "clean": {
            "command": ["rm -rf build",
                        "rm -rf coverage",
                        "rm -rf giottojs/media/*.js",
                        "rm -rf giottojs/media/*.css",
                        "rm -rf giottojs/media/*.json",
                        "rm -rf giottojs/media/lux"]
        }
    },
    "s3": {
        "options": {
            "bucket": "quantmind-public"
        },
        "giotto": {
            "files": {
                "build/*.js": "giotto/{{ package.version }}/",
                "build/*.css": "giotto/{{ package.version }}/"
            }
        }
    },
    "tasks": {
        "clean": {
            "description": "Remove build files and directories",
            "command": ["shell:clean"]
        },
        "install": {
            "description": "Install and download assets for giotto and giottojs",
            "command": ["httpcopy"]
        },
        "giotto": {
            "description": "Create the build/giotto.(js/css) files",
            "command": ["shell:giotto", "sass:giotto"]
        },
        "giottojs": {
            "description": "Create the giottojs/media/giottojs.(js/css) files",
            "command": ["shell:giottojs", "sass:giottojs"]
        },
        "release": {
            "description": "Make a new release",
            "command": ["s3:giotto"]
        }
    }
}
